# volatile

`volatile`(不稳定的)限定符修饰的变量,代理(而不是变量所在的程序)可以改变该变量的值.

>通常他被用于硬件地址以及其它程序或同时运行的线程中共享数据.例如,一个地址上可能储存着当前的时钟时间,地址上的值都随时间的变化而改变.或者一个地址用于接受另一台计算机传入的信息.(C Primer Plus)

# volatile的应用

volatile语法与const语法类似

```c++
volatile int a;
volatile int* b;
```

## 防止编译器优化

```c++
int a = 0;
void test()
{
	for(int i = 0;i<5;i++)
        a = i;
}
```

上述代码经编译器优化后可能为如下代码

```c++
void test()
{
    a = 4;
}
```

若将`a`用`volatile`修饰,告诉编译器`a`是一个不稳定的变量,不要优化,按`for`循环赋值.

>通常情况下,编译器会优化代码将变量从内存临时储存在CPU寄存器中.这个过程称为高速缓冲.在多线程任务中,若一个线程改变了变量而并没有及时同步到其它线程中会导致程序出错.将变量修饰为volatile会告诉编译器不进行高速缓冲.

可以同时用`const`和`volatile`限定一个值.

>  用const和volatile同时限定一个变量,该变量程序不可修改但可以通过代理修改.

